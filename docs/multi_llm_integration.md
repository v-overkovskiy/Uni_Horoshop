# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è MultiLLMClient —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –º–µ–∂–¥—É OpenAI GPT-4o-mini –∏ Anthropic Claude –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è 100% –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤, –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –æ–¥–Ω–æ–≥–æ –∏–∑ LLM.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### MultiLLMClient

–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π:
1. **–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç OpenAI GPT-4o-mini** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ Claude** –ø—Ä–∏:
   - –û—Ç–∫–∞–∑–µ OpenAI (content policy)
   - –û—à–∏–±–∫–∞—Ö API
   - –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ OpenAI

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã

–û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥—É–ª–∏:
- `src/llm/unified_content_generator.py`
- `src/processing/advantages_generator.py`
- `src/processing/faq_generator.py`
- `src/processing/characteristics_translator.py`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# OpenAI (–æ—Å–Ω–æ–≤–Ω–æ–π)
OPENAI_API_KEY=sk-your-openai-key

# Anthropic (fallback)
ANTHROPIC_API_KEY=sk-ant-api03-your-anthropic-key
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ API –∫–ª—é—á–µ–π
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–π fallback

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ú–µ—Ç–æ–¥—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```python
# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
stats = client.get_stats()
print(f"OpenAI —É—Å–ø–µ—à–Ω–æ: {stats['openai_success']}")
print(f"OpenAI –æ—Ç–∫–∞–∑–æ–≤: {stats['openai_failed']}")
print(f"Claude fallback: {stats['claude_used']}")

# –í—ã–≤–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
client.print_stats()
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
================================================================================
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø LLM:
================================================================================
   ‚úÖ OpenAI —É—Å–ø–µ—à–Ω–æ: 45
   ‚ùå OpenAI –æ—Ç–∫–∞–∑–æ–≤: 3
   üîÑ Claude fallback: 3
   üìà –ü—Ä–æ—Ü–µ–Ω—Ç Claude: 6.3%
================================================================================
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–∞–∑–æ–≤

### –î–µ—Ç–µ–∫—Ü–∏—è –æ—Ç–∫–∞–∑–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Ç–∫–∞–∑—ã –ø–æ:
- –ö–ª—é—á–µ–≤—ã–º —Ñ—Ä–∞–∑–∞–º: "–∑–∞–ø—Ä–µ—â–µ–Ω–æ", "–Ω–µ –º–æ–≥—É", "cannot"
- –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–º –æ—Ç–≤–µ—Ç–∞–º (< 20 —Å–∏–º–≤–æ–ª–æ–≤)
- –®–∞–±–ª–æ–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–∞–º: "–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç"

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –æ—Ç–∫–∞–∑–∞:
1. –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ Claude
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ fallback
4. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.llm.multi_llm_client import MultiLLMClient

client = MultiLLMClient()

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback
content = await client.generate(
    prompt="–°–æ–∑–¥–∞–π –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞",
    max_tokens=500,
    temperature=0.7
)
```

### –í –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```python
class AdvantagesGenerator:
    def __init__(self):
        self.llm = MultiLLMClient()
    
    async def generate_advantages(self, product_facts, locale):
        prompt = self._build_prompt(product_facts, locale)
        
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ
        response = await self.llm.generate(prompt, max_tokens=300)
        
        return self._parse_response(response)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **100% –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤** –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ LLM
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **–ì–∏–±–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ LLM
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –∏ –æ—Ç–∫–∞–∑–æ–≤
- **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ö–∞—á–µ—Å—Ç–≤–æ
- **Claude –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤** (–∫–æ—Å–º–µ—Ç–∏–∫–∞, –¥–µ–ø–∏–ª—è—Ü–∏—è)
- **OpenAI –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
- **–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ Claude

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `claude-instant-1`. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```python
# –í src/llm/multi_llm_client.py
response = await self.claude.messages.create(
    model="claude-3-sonnet-20240229",  # –í–∞—à–∞ –º–æ–¥–µ–ª—å
    # ...
)
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —É—Ä–æ–≤–Ω—è–º–∏:

- `INFO`: –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `WARNING`: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∏ –æ—Ç–∫–∞–∑—ã
- `ERROR`: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è MultiLLMClient –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- ‚úÖ 100% –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- ‚úÖ –ï–¥–∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- ‚úÖ –õ–µ–≥–∫—É—é —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∏ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ª—é–±—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Å–±–æ–µ–≤.
